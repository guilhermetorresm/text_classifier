(text_classifier) PS C:\Users\guigi\OneDrive\Documentos\Universidade\text_classifier> uv run .\main.py
=== Iniciando o pipeline de classificação de texto ===
=== Carregando os dados ===
=== Dataset de Treino ===
Formato: (120000, 5)
Primeiras linhas:
   Class                                              Title  \
0      2  Wall St. Bears Claw Back Into the Black (Reuters)   
1      2  Carlyle Looks Toward Commercial Aerospace (Reu...   
2      2    Oil and Economy Cloud Stocks' Outlook (Reuters)   
3      2  Iraq Halts Oil Exports from Main Southern Pipe...   
4      2  Oil prices soar to all-time record, posing new...   

                                         Description ClassName  
0  Reuters - Short-sellers, Wall Street's dwindli...  Business  
1  Reuters - Private investment firm Carlyle Grou...  Business  
2  Reuters - Soaring crude prices plus worries\ab...  Business  
3  Reuters - Authorities have halted oil export\f...  Business  
4  AFP - Tearaway world oil prices, toppling reco...  Business  
Distribuição das classes:
ClassName
Business    30000
Sci/Tech    30000
Sports      30000
World       30000
Name: count, dtype: int64

=== Dataset de Teste ===
Formato: (7600, 5)
Primeiras linhas:
   Class                                              Title  \
0      2                  Fears for T N pension after talks   
1      3  The Race is On: Second Private Team Sets Launc...   
2      3      Ky. Company Wins Grant to Study Peptides (AP)   
3      3      Prediction Unit Helps Forecast Wildfires (AP)   
4      3        Calif. Aims to Limit Farm-Related Smog (AP)   

                                         Description ClassName  
0  Unions representing workers at Turner   Newall...  Business  
1  SPACE.com - TORONTO, Canada -- A second\team o...  Sci/Tech  
2  AP - A company founded by a chemistry research...  Sci/Tech  
3  AP - It's barely dawn when Mike Fitzpatrick st...  Sci/Tech  
4  AP - Southern California's smog-fighting agenc...  Sci/Tech  
Distribuição das classes:
ClassName
Business    1900
Sci/Tech    1900
Sports      1900
World       1900
Name: count, dtype: int64

=== Pré-processamento do texto ===
[nltk_data] Downloading package stopwords to
[nltk_data]     C:\Users\guigi\AppData\Roaming\nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
[nltk_data] Downloading package wordnet to
[nltk_data]     C:\Users\guigi\AppData\Roaming\nltk_data...
[nltk_data]   Package wordnet is already up-to-date!
[nltk_data] Downloading package punkt to
[nltk_data]     C:\Users\guigi\AppData\Roaming\nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt_tab to
[nltk_data]     C:\Users\guigi\AppData\Roaming\nltk_data...
[nltk_data]   Package punkt_tab is already up-to-date!
[nltk_data] Downloading package omw-1.4 to
[nltk_data]     C:\Users\guigi\AppData\Roaming\nltk_data...
[nltk_data]   Package omw-1.4 is already up-to-date!
Exemplos de texto antes e depois da limpeza:

Exemplo 1:
Original: Wall St. Bears Claw Back Into the Black (Reuters) Reuters - Short-sellers, Wall Street's dwindling\b...
Limpo: wall bear claw back black reuters reuters shortsellers wall street dwindlingband ultracynics seeing ...

Exemplo 2:
Original: Carlyle Looks Toward Commercial Aerospace (Reuters) Reuters - Private investment firm Carlyle Group,...
Limpo: carlyle look toward commercial aerospace reuters reuters private investment firm carlyle groupwhich ...

Exemplo 3:
Original: Oil and Economy Cloud Stocks' Outlook (Reuters) Reuters - Soaring crude prices plus worries\about th...
Limpo: oil economy cloud stock outlook reuters reuters soaring crude price plus worriesabout economy outloo...

Tempo de pré-processamento: 20.85 segundos

=== Pré-processamento do texto ===
[nltk_data] Downloading package stopwords to
[nltk_data]     C:\Users\guigi\AppData\Roaming\nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
[nltk_data] Downloading package wordnet to
[nltk_data]     C:\Users\guigi\AppData\Roaming\nltk_data...
[nltk_data]   Package wordnet is already up-to-date!
[nltk_data] Downloading package punkt to
[nltk_data]     C:\Users\guigi\AppData\Roaming\nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt_tab to
[nltk_data]     C:\Users\guigi\AppData\Roaming\nltk_data...
[nltk_data]   Package punkt_tab is already up-to-date!
[nltk_data] Downloading package omw-1.4 to
[nltk_data]     C:\Users\guigi\AppData\Roaming\nltk_data...
[nltk_data]   Package omw-1.4 is already up-to-date!
Exemplos de texto antes e depois da limpeza:

Exemplo 1:
Original: Fears for T N pension after talks Unions representing workers at Turner   Newall say they are 'disap...
Limpo: fear pension talk union representing worker turner newall say disappointed talk stricken parent firm...

Exemplo 2:
Original: The Race is On: Second Private Team Sets Launch Date for Human Spaceflight (SPACE.com) SPACE.com - T...
Limpo: race second private team set launch date human spaceflight spacecom spacecom toronto canada secondte...

Exemplo 3:
Original: Ky. Company Wins Grant to Study Peptides (AP) AP - A company founded by a chemistry researcher at th...
Limpo: company win grant study peptide company founded chemistry researcher university louisville grant dev...

Tempo de pré-processamento: 1.20 segundos

=== Criando representações vetoriais ===
Criando vetorização com Bag of Words (frequência de unigramas)...
Dimensões da matriz BoW para treino: (120000, 10000)
Dimensões da matriz BoW para teste: (7600, 10000)
Número de características (palavras únicas): 10000
Tempo de vetorização BoW: 1.75 segundos

Criando vetorização com TF-IDF...
Dimensões da matriz TF-IDF para treino: (120000, 10000)
Dimensões da matriz TF-IDF para teste: (7600, 10000)
Número de características (palavras únicas): 10000
Tempo de vetorização TF-IDF: 1.78 segundos

As 20 palavras mais frequentes foram salvas como 'top_words.png'

=== Treinamento e avaliação dos modelos ===

1. Treinando Random Forest com Bag of Words...
Tempo de treinamento: 44.51 segundos

2. Treinando Random Forest com TF-IDF...
Tempo de treinamento: 39.88 segundos

3. Treinando SVM com Bag of Words...
Tempo de treinamento: 3431.68 segundos

4. Treinando SVM com TF-IDF...
Tempo de treinamento: 1372.03 segundos

=== Visualização e comparação dos resultados ===

O melhor modelo é: SVM_TF-IDF com acurácia de 0.9100

Resumo das métricas para todos os modelos:
    Modelo  Acurácia  Precisão Macro  Revocação Macro  F1 Macro  Tempo Treinamento (s)
    RF_BoW  0.885263        0.884766         0.885263  0.884829              44.510286
 RF_TF-IDF  0.884737        0.884373         0.884737  0.884296              39.876336
   SVM_BoW  0.886579        0.886351         0.886579  0.886422            3431.681257
SVM_TF-IDF  0.910000        0.909849         0.910000  0.909826            1372.027429

=== Análise Detalhada dos Resultados ===

Distribuição das classes no conjunto de treino:
Class
2    30000
3    30000
1    30000
0    30000
Name: count, dtype: int64

Distribuição das classes no conjunto de teste:
Class
2    1900
3    1900
1    1900
0    1900
Name: count, dtype: int64

Análise de desempenho por classe para cada modelo:

RF_BoW:
Classe mais difícil: Business
F1-Score: 0.8468
Precisão: 0.8531
Revocação: 0.8405

Classe mais fácil: Sports
F1-Score: 0.9427
Precisão: 0.9207
Revocação: 0.9658

RF_TF-IDF:
Classe mais difícil: Business
F1-Score: 0.8464
Precisão: 0.8487
Revocação: 0.8442

Classe mais fácil: Sports
F1-Score: 0.9399
Precisão: 0.9148
Revocação: 0.9663

SVM_BoW:
Classe mais difícil: Business
F1-Score: 0.8450
Precisão: 0.8551
Revocação: 0.8353

Classe mais fácil: Sports
F1-Score: 0.9549
Precisão: 0.9519
Revocação: 0.9579

SVM_TF-IDF:
Classe mais difícil: Business
F1-Score: 0.8725
Precisão: 0.8734
Revocação: 0.8716

Classe mais fácil: Sports
F1-Score: 0.9654
Precisão: 0.9533
Revocação: 0.9779

O melhor modelo geral é SVM_TF-IDF com acurácia de 0.9100

Análise dos tipos de erro para o melhor modelo (SVM_TF-IDF):

Classe: World
Taxa de erro: 0.1047 (199 de 1900)
Mais frequentemente confundida com: Business (95 amostras)

Classe: Sports
Taxa de erro: 0.0221 (42 de 1900)
Mais frequentemente confundida com: World (25 amostras)

Classe: Business
Taxa de erro: 0.1284 (244 de 1900)
Mais frequentemente confundida com: Sci/Tech (158 amostras)

Classe: Sci/Tech
Taxa de erro: 0.1047 (199 de 1900)
Mais frequentemente confundida com: Business (136 amostras)

Análise dos resultados concluída e salva em arquivos de imagem.

=== Pipeline de classificação concluído em 81.94 minutos ===
O melhor modelo foi SVM_TF-IDF com acurácia de 0.9100
Todas as visualizações e métricas foram salvas em arquivos para análise posterior.
(text_classifier) PS C:\Users\guigi\OneDrive\Documentos\Universidade\text_classifier>